" set backspace=indent,eol,start                  " allow backspacing over everything in insert mode
" set ruler                                       " show the cursor position all the time
set incsearch                                   " do incremental searching
set list
set lcs=tab:>-,trail:-
set nu
set hlsearch
set mouse=a
let c_space_errors=1

set backupdir=~/.vim/.bak
set directory=~/.vim/.bak

set autoindent
set foldmethod=syntax
set foldlevel=99
nnoremap <space> za

if has("autocmd")
  au BufReadPost * if line("'\"") > 1 && line("'\"") <= line("$") | exe "normal! g'\"" | endif
endif

"python with virtualenv support
if has('python')
python << EOF
import os
import sys
if 'VIRTUAL_ENV' in os.environ:
  project_base_dir = os.environ['VIRTUAL_ENV']
  activate_this = os.path.join(project_base_dir, 'bin/activate_this.py')
  execfile(activate_this, dict(__file__=activate_this))
EOF
elseif has('python3')
python3 << EOF
import os
import sys
if 'VIRTUAL_ENV' in os.environ:
  project_base_dir = os.environ['VIRTUAL_ENV']
  activate_this = os.path.join(project_base_dir, 'bin/activate_this.py')
  with open(activate_this, 'r') as f:
    exec(f.read(), dict(__file__=activate_this))
EOF
endif

"key mappings
"""""""""""""""""""""""""""""""""""""""""""""""
imap jk <ESC>
vmap <silent> * :call VisualSelection('f')<CR>
vmap <silent> # :call VisualSelection('b')<CR>
map <space> za
" Opens a new tab with the current buffer's path
map <leader>tn :tabnew
map <leader>tb :tabnext <cr>
map <leader>tp :tabprevious <cr>
map <leader>te :tabedit <c-r>=expand("%:p:h")<cr>/
map <leader>cp :cd %:p:h<cr>:pwd<cr>
map <leader>ag :Ag! 
map <leader>af :AgFile! 
nmap <C-j> <C-W>j
nmap <C-k> <C-W>k
nmap <C-h> <C-W>h
nmap <C-l> <C-W>l

autocmd InsertLeave * se nocul  " 用浅色高亮当前行
autocmd InsertEnter * se cul    " 用浅色高亮当前行
autocmd FileType python,java,sh,vim,markdown,go
    \ setlocal expandtab | setlocal tabstop=4 |
    \ setlocal softtabstop=4 | setlocal shiftwidth=4

autocmd BufRead *.js,*.html,*.rb
    \ setlocal expandtab | setlocal tabstop=2 |
    \ setlocal softtabstop=2 | setlocal shiftwidth=2
autocmd BufRead *.thrift,*.c,*.cc,*.cpp,*.sql
    \ setlocal expandtab | setlocal tabstop=4 |
    \ setlocal softtabstop=4 | setlocal shiftwidth=4
autocmd BufNewFile
    \ *.py
    \ setlocal expandtab | setlocal tabstop=4 |
    \ setlocal softtabstop=4 | setlocal shiftwidth=4 |
    \ call append(0, "#!/usr/bin/env python") |
    \ call append(1, "# -*- coding: utf-8 -*-")

"""""""""""" ycm """""""""""""""""""
let g:ycm_global_ycm_extra_conf = '~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp/ycm/.ycm_extra_conf.py'
nnoremap <leader>jd :YcmCompleter GoToDefinitionElseDeclaration<CR>


""""""" Nerdtree """""""""""""""""""
 "open if vim open with no file
autocmd StdinReadPre * let s:std_in=1
autocmd VimEnter * if argc() == 0 && !exists("s:std_in") | NERDTree | endif
 "close if only nerdwindow left
autocmd bufenter * if (winnr("$") == 1 && exists("b:NERDTreeType") && b:NERDTreeType == "primary") | q | endif
map <Leader>nt :NERDTreeToggle<CR>

"""""""" indentLine """"""""""""""""
let g:intdentline_char = '|'

let g:SimpylFold_docstring_preview=1

filetype off                  " required
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
Plugin 'gmarik/Vundle.vim'

" Plugin 'Valloric/ListToggle'

Bundle 'altercation/vim-colors-solarized'
Bundle 'scrooloose/nerdtree'
Bundle 'kien/ctrlp.vim'
Bundle 'rking/ag.vim'
Bundle 'Raimondi/delimitMate'
Plugin 'Valloric/YouCompleteMe'
Plugin 'tmhedberg/SimpylFold'
Plugin 'vim-scripts/indentpython.vim'
Plugin 'tpope/vim-fugitive'
Plugin 'Yggdroot/indentLine'
Plugin 'fatih/vim-go'

"track the engine.
" Plugin 'scrooloose/syntastic'
"Plugin 'SirVer/ultisnips'
" Snippets are separated from the engine. Add this if you want them:
" Plugin 'honza/vim-snippets'
" 
" Bundle "git://github.com/MarcWeber/vim-addon-mw-utils.git"
" Bundle "git://github.com/tomtom/tlib_vim.git"
" 
" Bundle 'ianva/vim-youdao-translater'
" Bundle 'kevinw/pyflakes-vim'
" Bundle 'terryma/vim-multiple-cursors'
" Bundle 'hdima/python-syntax'
" Bundle 'tpope/vim-surround'
" Bundle 'tpope/vim-repeat'
" Bundle 'ntpeters/vim-better-whitespace'
" Bundle 'bronson/vim-trailing-whitespace'
" Bundle 'scrooloose/nerdcommenter'
" Bundle 'Lokaltog/vim-powerline'
" Bundle 'majutsushi/tagbar'
"括号显示增强
" Bundle 'kien/rainbow_parentheses.vim'
" Bundle 'Emmet.vim'
" Bundle 'mattn/webapi-vim'
" Bundle 'mattn/gist-vim'
" Bundle 'AutoComplPop'
" Bundle 'taglist.vim'
" Bundle 'Vim-Support'
" Bundle 'winmanager--Fox'
call vundle#end()            " required
filetype plugin on

syntax enable
" 配色方案
" set background=light
set background=dark
colorscheme solarized
